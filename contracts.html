<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>WARM UP UK — Contract</title>

<!-- libs just for PDF later if you keep them; safe to leave for now -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<style>
  :root{
    --ink:#111;
    --line:#e7e7e7;
    --panel:#fafafa;
    --brand:#000;
    --gold:#d4af37;
    --danger:#b00020;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:#f6f7f8; color:var(--ink);
    font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  .sheet{max-width:920px; margin:16px auto 72px; padding:16px}
  .card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:14px}

  /* header */
  header.brand{display:flex;align-items:center;gap:16px}
  header .logo{width:150px;height:auto;object-fit:contain} /* bigger on mobile */
  header .hblock{flex:1}
  header h1{margin:0;font-size:36px;letter-spacing:.06em}
  header .addr{margin-top:6px;color:#333}
  .meta2{display:grid;grid-template-columns:1fr 1fr; gap:10px; margin-top:12px}
  .meta2 .box{background:var(--panel);border:1px solid var(--line);border-radius:10px;padding:10px}
  .meta2 label{display:block;font-size:12px;color:#555;margin-bottom:6px}
  .meta2 input{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;font-size:16px}

  /* section */
  h2.section{margin:18px 0 10px;font-size:18px}

  .grid2{display:grid;grid-template-columns:1fr 1fr; gap:12px}
  @media (max-width:760px){ .grid2{grid-template-columns:1fr} }

  .box{background:#fff;border:1px solid var(--line);border-radius:10px;padding:12px}

  /* inputs */
  label{font-size:12px;color:#555;margin-bottom:6px;display:block}
  input,select,textarea{width:100%;padding:10px;border:1px solid #cfcfcf;border-radius:8px;font-size:16px;background:#fff}
  textarea{min-height:120px;resize:vertical}

  /* product lines */
  .lines{display:grid;gap:12px}
  .line{border:1px solid var(--line);border-radius:12px;background:#fbfbfb;padding:12px}
  .p-top{display:block;margin-bottom:10px}
  .p-row{display:grid;grid-template-columns:1fr 1fr 1fr; gap:10px}
  .p-row .cell input[readonly]{background:#efefef}
  @media (max-width:720px){ .p-row{grid-template-columns:1fr 1fr 1fr} }

  .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  button{border:0;border-radius:10px;padding:12px 16px;font-weight:800;cursor:pointer;background:#111;color:#fff}
  .btn-gold{background:var(--gold); color:#000}
  .btn-red{background:#d31212}
  .btn-dark{background:#222}

  /* options & totals */
  .options{display:grid;gap:10px}
  .switch{display:flex;align-items:center;gap:10px}
  .fine{font-size:12px;color:#666}
  .totals{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff;margin-top:12px}
  .row{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px dashed #e2e2e2}
  .row:last-child{border-bottom:none}
  .grand .val{font-weight:900;font-size:22px}
  .val{min-width:140px;text-align:right;font-variant-numeric:tabular-nums}

  /* notes wider */
  .notes textarea{min-height:140px}

  /* waiver */
  .waiver{border:2px solid var(--danger);background:#fff7f7;border-radius:12px;padding:12px}
  .waiver h3{margin:0 0 8px;color:var(--danger)}

  /* signatures */
  .sigs{display:grid;grid-template-columns:1fr 1fr; gap:12px}
  @media (max-width:760px){ .sigs{grid-template-columns:1fr} }
  .sig{background:#fff;border:1px dashed #bbb;border-radius:10px;padding:10px}
  .sig canvas{width:100%;height:200px;border:1px solid #ccc;border-radius:8px;background:#fff;touch-action:none}
  .sig .under{display:flex;gap:8px;margin-top:8px}
  .sig .under input{flex:1}

  .footer{margin-top:10px;text-align:center;color:#666;font-size:12px}
</style>
</head>
<body>
  <div class="sheet">

    <!-- HEADER -->
    <div class="card">
      <header class="brand">
        <img class="logo" src="warmupuklogo.jpg" alt="WARM UP UK">
        <div class="hblock">
          <h1>WARM UP UK</h1>
          <div class="addr">321–323 Romford High Road, Essex RM6 6AX · <strong>Tel:</strong> <a href="tel:01708300670">01708 300670</a></div>
        </div>
      </header>

      <div class="meta2">
        <div class="box">
          <label>Contract #</label>
          <input id="contractNo" readonly>
        </div>
        <div class="box">
          <label>Date</label>
          <input id="contractDate" readonly>
        </div>
      </div>
    </div>

    <!-- CUSTOMER -->
    <h2 class="section">Customer</h2>
    <div class="grid2">
      <div class="box">
        <label>Customer Name</label>
        <input id="custName" placeholder="Full name">
        <label>Property Address</label>
        <input id="custAddr" placeholder="House/Street, Town, Postcode">
      </div>
      <div class="box">
        <label>Phone</label>
        <input id="custPhone" placeholder="07…">
        <label>Email</label>
        <input id="custEmail" placeholder="email@example.com">
      </div>
    </div>

    <!-- PRODUCTS -->
    <h2 class="section">Products / Services</h2>
    <div id="lines" class="lines"></div>
    <div class="btns">
      <button id="addLine" class="btn-gold">+ Add Line</button>
      <button id="removeLine" class="btn-gold">– Remove Last</button>
      <button id="clearLines" class="btn-red">Clear Lines</button>
    </div>

    <!-- OPTIONS -->
    <h2 class="section">Options</h2>
    <div class="box options">
      <div class="switch">
        <input type="checkbox" id="applyVAT">
        <label for="applyVAT">Apply <strong>VAT 20%</strong></label>
      </div>
      <div class="fine">Admin Fee of <strong>£150</strong> is automatically applied.</div>
      <div>
        <label>Install Date</label>
        <input type="date" id="installDate">
      </div>
    </div>

    <!-- TOTALS -->
    <h2 class="section">Totals</h2>
    <div class="totals" id="totalsBox">
      <div class="row"><div>Subtotal</div><div class="val" id="subtotal">£ 0.00</div></div>
      <div class="row"><div>Admin Fee</div><div class="val" id="admin">£ 150.00</div></div>
      <div class="row"><div>VAT (20%)</div><div class="val" id="vat">£ 0.00</div></div>
      <div class="row grand"><div>Grand Total</div><div class="val" id="grand">£ 150.00</div></div>
      <div class="row">
        <div>Less Deposit</div>
        <div class="val"><span>£ </span><input id="deposit" type="number" min="0" step="0.01" value="0" style="width:120px;text-align:right"></div>
      </div>
      <div class="row"><div><strong>Balance Due</strong></div><div class="val" id="balance"><strong>£ 150.00</strong></div></div>
    </div>

    <!-- NOTES (wider) -->
    <h2 class="section">Notes</h2>
    <div class="box notes">
      <textarea id="notes" placeholder="Any specific instructions or clarifications…"></textarea>
    </div>

    <!-- WAIVER -->
    <h2 class="section">Express Waiver</h2>
    <div class="waiver">
      <h3>Express Waiver</h3>
      <p>I request that WARM UP UK begins work before the end of my 14-day cooling-off period. I understand this may affect my right to cancel once the work has started and materials have been ordered or installed.</p>
      <label style="display:flex;gap:10px;align-items:center"><input id="waiverAck" type="checkbox"> I acknowledge and accept the Express Waiver.</label>
    </div>

    <!-- SIGNATURES (stack on mobile) -->
    <h2 class="section">Signatures</h2>
    <div class="sigs">
      <div class="sig">
        <strong>Customer Signature</strong>
        <canvas id="sigCustomer"></canvas>
        <div class="under">
          <input id="sigCustName" placeholder="Customer printed name">
          <button type="button" id="clearSigCustomer" class="btn-dark">Clear</button>
        </div>
      </div>
      <div class="sig">
        <strong>Company Signature</strong>
        <canvas id="sigCompany"></canvas>
        <div class="under">
          <input id="sigCompName" placeholder="Company representative">
          <button type="button" id="clearSigCompany" class="btn-dark">Clear</button>
        </div>
      </div>
    </div>

    <div class="footer">WARM UP UK • 321–323 Romford High Road, Essex RM6 6AX • 01708 300670</div>
  </div>

<script>
/* ===== Header numbers/dates ===== */
function genContractNo(){
  const d=new Date(), pad=n=>String(n).padStart(2,'0');
  return `WUU-${d.getFullYear().toString().slice(-2)}${pad(d.getMonth()+1)}${pad(d.getDate())}-${pad(d.getHours())}${pad(d.getMinutes())}-${Math.floor(1000+Math.random()*9000)}`;
}
function todayDMY(){
  const d=new Date(), p=n=>String(n).padStart(2,'0');
  return `${p(d.getDate())}-${p(d.getMonth()+1)}-${d.getFullYear()}`;
}
document.getElementById('contractNo').value = genContractNo();
document.getElementById('contractDate').value = todayDMY();

/* ===== Products ===== */
const PRODUCT_OPTIONS = [
  "Loft Insulation 270mm Fibreglass",
  "Multifoil YBS SuperQuilt",
  "Pitched Roof TLX Silver",
  "Cavity Wall Insulation",
  "Spray Foam Removal",
  "Loft Boarding",
  "Ventilation Upgrade",
  "Vermin Treatment",
  "Timber Treatment"
];
const linesEl = document.getElementById('lines');

function makeSelect(){
  const sel=document.createElement('select');
  sel.innerHTML = `<option value="" disabled selected>Choose a product...</option>` +
    PRODUCT_OPTIONS.map(p=>`<option value="${p}">${p}</option>`).join('');
  return sel;
}
function currency(n){ return "£ " + Number(n||0).toFixed(2); }

function makeLine(){
  const wrap=document.createElement('div'); wrap.className='line';

  const top=document.createElement('div'); top.className='p-top';
  const lab=document.createElement('label'); lab.textContent='Product';
  const sel=makeSelect();
  top.appendChild(lab); top.appendChild(sel);

  const row=document.createElement('div'); row.className='p-row';
  // Qty
  const c1=document.createElement('div'); c1.className='cell';
  c1.innerHTML = `<label>Qty</label><input type="number" min="0" step="1" value="0">`;
  // Unit
  const c2=document.createElement('div'); c2.className='cell';
  c2.innerHTML = `<label>Unit £</label><input type="number" min="0" step="0.01" value="0">`;
  // Line total (read only)
  const c3=document.createElement('div'); c3.className='cell';
  c3.innerHTML = `<label>Line Total</label><input type="text" value="£ 0.00" readonly>`;
  row.append(c1,c2,c3);

  wrap.append(top,row);

  const recalc=()=>{
    const q=Number(c1.querySelector('input').value||0);
    const u=Number(c2.querySelector('input').value||0);
    c3.querySelector('input').value = currency(q*u);
    recalcTotals();
  };
  c1.querySelector('input').addEventListener('input', recalc);
  c2.querySelector('input').addEventListener('input', recalc);
  sel.addEventListener('change', recalc);

  return wrap;
}
function addLine(){ linesEl.appendChild(makeLine()); recalcTotals(); }
function removeLine(){ if(linesEl.lastElementChild){ linesEl.lastElementChild.remove(); recalcTotals(); } }
function clearLines(){ linesEl.innerHTML=''; addLine(); recalcTotals(); }

document.getElementById('addLine').addEventListener('click', addLine);
document.getElementById('removeLine').addEventListener('click', removeLine);
document.getElementById('clearLines').addEventListener('click', clearLines);

// start with 3 lines
addLine(); addLine(); addLine();

/* ===== Totals ===== */
const subtotalEl=document.getElementById('subtotal');
const adminEl=document.getElementById('admin');
const vatEl=document.getElementById('vat');
const grandEl=document.getElementById('grand');
const balanceEl=document.getElementById('balance');
const depositEl=document.getElementById('deposit');
const applyVAT=document.getElementById('applyVAT');

function getSubtotal(){
  let s=0;
  linesEl.querySelectorAll('.line').forEach(l=>{
    const q=Number(l.querySelector('.p-row .cell:nth-child(1) input').value||0);
    const u=Number(l.querySelector('.p-row .cell:nth-child(2) input').value||0);
    s+=q*u;
  });
  return s;
}
function recalcTotals(){
  const admin=150;
  const subtotal=getSubtotal();
  const vat = applyVAT.checked ? 0.20*(subtotal+admin) : 0;
  const grand = subtotal + admin + vat;
  const deposit=Number(depositEl.value||0);
  const balance = Math.max(grand - deposit, 0);

  subtotalEl.textContent = currency(subtotal);
  adminEl.textContent = currency(admin);
  vatEl.textContent = currency(vat);
  grandEl.textContent = currency(grand);
  balanceEl.textContent = currency(balance);
}
applyVAT.addEventListener('change', recalcTotals);
depositEl.addEventListener('input', recalcTotals);

/* ===== Signature pads (touch + mouse, no page scroll) ===== */
function makeSig(canvas){
  const ctx=canvas.getContext('2d');
  let drawing=false, lastX=0, lastY=0;

  function resize(){
    const dpr=Math.max(window.devicePixelRatio||1,1);
    const r=canvas.getBoundingClientRect();
    canvas.width=Math.round(r.width*dpr);
    canvas.height=Math.round(r.height*dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
    ctx.lineWidth=2; ctx.lineCap='round'; ctx.strokeStyle='#000';
  }
  resize(); window.addEventListener('resize', resize);

  function pos(e){
    const r=canvas.getBoundingClientRect();
    if(e.touches && e.touches[0]) return {x:e.touches[0].clientX-r.left, y:e.touches[0].clientY-r.top};
    return {x:e.clientX-r.left, y:e.clientY-r.top};
  }
  function lock(locking){ document.documentElement.style.overflow = locking ? 'hidden' : '' }

  function start(e){ drawing=true; lock(true); const p=pos(e); lastX=p.x; lastY=p.y; e.preventDefault(); }
  function move(e){
    if(!drawing) return;
    const p=pos(e);
    ctx.beginPath(); ctx.moveTo(lastX,lastY); ctx.lineTo(p.x,p.y); ctx.stroke();
    lastX=p.x; lastY=p.y; e.preventDefault();
  }
  function end(){ drawing=false; lock(false); }

  canvas.addEventListener('mousedown', start);
  canvas.addEventListener('mousemove', move);
  window.addEventListener('mouseup', end);
  canvas.addEventListener('touchstart', start, {passive:false});
  canvas.addEventListener('touchmove', move, {passive:false});
  window.addEventListener('touchend', end);

  return {
    clear(){ ctx.clearRect(0,0,canvas.width,canvas.height); resize(); },
    data(){ return canvas.toDataURL('image/png'); }
  }
}
const sigCust = makeSig(document.getElementById('sigCustomer'));
const sigComp = makeSig(document.getElementById('sigCompany'));
document.getElementById('clearSigCustomer').addEventListener('click', ()=>sigCust.clear());
document.getElementById('clearSigCompany').addEventListener('click', ()=>sigComp.clear());

/* ===== Recalc once on load ===== */
recalcTotals();
</script>
</body>
</html>
