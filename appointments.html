<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>WARM UP UK HOMES — Appointments</title>
<meta name="color-scheme" content="dark"/>
<style>
  :root{--bg:#0b0b0b;--panel:#121212;--ink:#f6f6f6;--muted:#b9b9b9;--gold:#d4af37;--gold2:#ffcd4d;--radius:16px;--shadow:0 10px 24px rgba(0,0,0,.45);--sans:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;font-family:var(--sans);color:var(--ink);background:var(--bg)}
  .wrap{max-width:1100px;margin:0 auto;padding:18px}
  header{background:linear-gradient(180deg,rgba(212,175,55,.16),rgba(212,175,55,.02)),#0f0f0f;border:1px solid rgba(212,175,55,.35);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);margin-bottom:14px}
  .title{font-weight:800;letter-spacing:.2em;text-transform:uppercase}
  .sub{color:var(--muted)}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.02),transparent),var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:14px;box-shadow:var(--shadow);margin-bottom:14px}
  label{display:block;font-size:13px;color:var(--muted);margin:8px 0 6px}
  input,select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:#0c0c0c;color:var(--ink);outline:none}
  .grid{display:grid;gap:10px;grid-template-columns:repeat(2,1fr)}
  @media(max-width:900px){.grid{grid-template-columns:1fr}}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:linear-gradient(180deg,var(--gold),var(--gold2));color:#111;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
  .btn.ghost{background:transparent;color:var(--ink);border-color:rgba(212,175,55,.4)}
  .row{display:grid;grid-template-columns:1.2fr .9fr 1.4fr .8fr .7fr auto;gap:8px;align-items:center}
  .list-head{color:var(--muted);font-size:12px;margin-bottom:6px}
  .pill{padding:4px 8px;border:1px solid rgba(255,255,255,.12);border-radius:999px;font-size:12px;color:var(--muted)}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .hint{color:var(--muted);font-size:12px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">WARM UP UK HOMES — Appointments</div>
    <div class="sub">Book survey visits and share details via WhatsApp · Black & Gold theme</div>
  </header>

  <!-- Create -->
  <section class="card">
    <h2 style="color:var(--gold);margin:0 0 8px">Create Appointment</h2>
    <div class="grid">
      <div><label>Client name</label><input id="cName" placeholder="Full name"></div>
      <div><label>Phone (WhatsApp)</label><input id="cPhone" placeholder="+44… or 07…"></div>
      <div><label>Address</label><input id="cAddr" placeholder="Address, Postcode"></div>
      <div><label>Rep</label><input id="cRep" placeholder="Rep name"></div>
      <div><label>Date</label><input id="cDate" type="date"></div>
      <div><label>Time</label><input id="cTime" type="time"></div>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
      <button class="btn" id="add">Save Appointment</button>
      <button class="btn ghost" id="wa">Send WhatsApp</button>
      <a class="btn ghost" id="toContract" href="contract.html" target="_blank">Open Contract</a>
    </div>
    <div class="hint">Tip: “Open Contract” launches your black & gold contract in a new tab to complete & sign.</div>
  </section>

  <!-- Week view -->
  <section class="card">
    <h2 style="color:var(--gold);margin:0 0 8px">This Week</h2>
    <div id="weekSummary" class="pill">Loading…</div>
  </section>

  <!-- List -->
  <section class="card">
    <div class="list-head row">
      <div>Client</div><div>Phone</div><div>Address</div><div>Date</div><div>Rep</div><div>Actions</div>
    </div>
    <div id="list"></div>
  </section>
</div>

<script>
const KEY='wuuk_appts';
const $=id=>document.getElementById(id);
$('cDate').value=new Date().toISOString().slice(0,10);

function read(){return JSON.parse(localStorage.getItem(KEY)||'[]')}
function write(v){localStorage.setItem(KEY,JSON.stringify(v))}
function uid(){return crypto.randomUUID()}

function startOfWeek(d){const x=new Date(d);const k=(x.getDay()+6)%7;x.setHours(0,0,0,0);x.setDate(x.getDate()-k);return x}
function endOfWeek(d){const a=startOfWeek(d);a.setDate(a.getDate()+7);return a}

function render(){
  const rows=read();
  const list=$('list'); list.innerHTML='';
  rows.sort((a,b)=>a.date.localeCompare(b.date)||a.time.localeCompare(b.time));
  rows.forEach(r=>{
    const div=document.createElement('div'); div.className='row';
    div.innerHTML=`
      <div>${r.name}</div>
      <div>${r.phone}</div>
      <div>${r.addr}</div>
      <div>${r.date} ${r.time||''}</div>
      <div>${r.rep||''}</div>
      <div class="actions">
        <button class="btn ghost" data-wa="${r.id}">WA</button>
        <button class="btn ghost" data-del="${r.id}">Del</button>
      </div>`;
    list.appendChild(div);
  });

  // week summary
  const now=new Date(); const from=startOfWeek(now), to=endOfWeek(now);
  const inWeek=rows.filter(r=>{const t=new Date(r.date); return t>=from && t<to});
  const perDay=[0,0,0,0,0,0,0];
  inWeek.forEach(r=>{const t=new Date(r.date); const i=(t.getDay()+6)%7; perDay[i]++});
  $('weekSummary').textContent=`${from.toLocaleDateString()} – ${new Date(to-1).toLocaleDateString()} · ${inWeek.length} appts · Mon–Sun: ${perDay.join(' / ')}`;
}
render();

$('add').onclick=()=>{
  const r={id:uid(),name:$('cName').value.trim(),phone:$('cPhone').value.trim(),addr:$('cAddr').value.trim(),rep:$('cRep').value.trim(),date:$('cDate').value,time:$('cTime').value};
  if(!r.name||!r.phone||!r.date){alert('Name, phone and date are required.');return}
  const rows=read(); rows.push(r); write(rows); render(); alert('Appointment saved.');
};
$('wa').onclick=()=>{
  const txt=`WARM UP UK HOMES – Appointment\nName: ${$('cName').value}\nAddress: ${$('cAddr').value}\nDate: ${$('cDate').value} ${$('cTime').value}\nRep: ${$('cRep').value}`;
  window.open('https://wa.me/?text='+encodeURIComponent(txt),'_blank');
};
document.addEventListener('click',e=>{
  if(e.target.dataset.del){ const id=e.target.dataset.del; write(read().filter(x=>x.id!==id)); render(); }
  if(e.target.dataset.wa){
    const r=read().find(x=>x.id===e.target.dataset.wa);
    const txt=`WARM UP UK HOMES – Appointment\nName: ${r.name}\nAddress: ${r.addr}\nDate: ${r.date} ${r.time||''}\nRep: ${r.rep||''}`;
    window.open('https://wa.me/?text='+encodeURIComponent(txt),'_blank');
  }
});
</script>
</body>
</html>
