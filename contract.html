<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MXCTECH INSULATION — Contract</title>

<style>
:root{
  --bg:#0b0e13;--panel:#1a1f25;--gold:#f2b632;--line:#2a3245;--text:#eef3ff;--muted:#9aa4bd;
}
body{margin:0;font-family:Arial,Segoe UI,sans-serif;background:var(--bg);color:var(--text);}
header{display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid var(--line);
background:linear-gradient(180deg,#151a25 0%,#0e121a 100%);}
header img{height:42px;width:auto;}
h1{font-size:20px;margin:0;font-weight:700;color:var(--gold);}
main{max-width:1100px;margin:auto;padding:20px;}
.card{background:var(--panel);border:1px solid var(--line);border-radius:10px;margin-bottom:18px;
box-shadow:0 6px 18px rgba(0,0,0,.4);}
.card h2{margin:0;padding:12px 16px;border-bottom:1px solid var(--line);
background:rgba(255,255,255,.03);color:var(--gold);}
.card .body{padding:16px;}
label{display:block;font-size:12px;margin-top:10px;color:var(--muted);}
input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid var(--line);
background:#0c1018;color:var(--text);}
.btn{display:inline-flex;align-items:center;justify-content:center;
padding:12px 18px;border-radius:8px;border:1px solid #333;
font-weight:700;cursor:pointer;margin-top:10px;}
.btn.gold{background:linear-gradient(180deg,#f5c556,#e9a91b);color:#0b0e13;}
.btn.green{background:linear-gradient(180deg,#39df9d,#10b981);color:#04140c;}
.btn.red{background:linear-gradient(180deg,#ff7777,#e55353);color:#1a0000;}
.actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px;}
table{width:100%;border-collapse:collapse;font-size:14px;}
th,td{padding:8px 6px;border-bottom:1px dashed var(--line);}
th{text-align:left;color:var(--muted);}
#signature{width:100%;height:200px;border:1px dashed var(--line);border-radius:8px;
background:#0a0f18;touch-action:none;margin-top:10px;}
</style>
</head>

<body>
<header>
  <img src="mxctech-logo.png" alt="MXCTECH INSULATION" onerror="this.style.display='none'">
  <h1>MXCTECH INSULATION — Contract</h1>
</header>

<main>
  <!-- Client Details -->
  <section class="card">
    <h2>Client Information</h2>
    <div class="body">
      <label>Client Name</label><input id="custName">
      <label>Phone (WhatsApp)</label><input id="custPhone" placeholder="+447123456789">
      <label>Email</label><input id="custEmail">
      <label>Address</label><input id="addr1">
      <label>Postcode</label><input id="postcode">
      <label>Appointment Date</label><input id="apptDate" type="date">
      <label>Representative</label><input id="repName">
      <label>Job Type</label><input id="jobType" placeholder="e.g. Insulation">
      <label>Notes</label><textarea id="notes" rows="3"></textarea>
    </div>
  </section>

  <!-- Products -->
  <section class="card">
    <h2>Products & Pricing</h2>
    <div class="body">
      <label>Product</label>
      <select id="product">
        <option value="">Select…</option>
        <option value="1500">Multifoil Insulation — £1500</option>
        <option value="950">Loft Boarding — £950</option>
        <option value="650">Draft Proofing — £650</option>
      </select>
      <label>Admin Fee (£)</label><input id="adminFee" type="number" value="150">
      <label>Add Custom Product</label>
      <input id="customTitle" placeholder="Custom Title">
      <input id="customPrice" type="number" placeholder="Price £">
      <div class="actions">
        <button class="btn" onclick="addSelectedProduct()">Add Product</button>
        <button class="btn" onclick="addCustomProduct()">Add Custom</button>
        <label><input type="checkbox" id="vatToggle" checked> VAT 20%</label>
      </div>
      <table id="items"><thead><tr><th>Item</th><th style="text-align:right">Price (£)</th><th></th></tr></thead><tbody></tbody></table>
      <label>Deposit (£)</label><input id="deposit" type="number" placeholder="1000">
      <div style="margin-top:12px;">
        <table>
          <tr><td>Subtotal</td><td id="subtotal" style="text-align:right">£0.00</td></tr>
          <tr><td>VAT</td><td id="vat" style="text-align:right">£0.00</td></tr>
          <tr><td><b>TOTAL</b></td><td id="total" style="text-align:right"><b>£0.00</b></td></tr>
          <tr><td>Deposit</td><td id="depOut" style="text-align:right">£0.00</td></tr>
        </table>
      </div>
    </div>
  </section>

  <!-- Signature -->
  <section class="card">
    <h2>Terms & Signature</h2>
    <div class="body">
      <p><b>Terms & Conditions:</b> Deposit is non-refundable. Balance due on completion. Access must be clear. 1 year workmanship warranty.</p>
      <canvas id="signature"></canvas>
      <div class="actions">
        <button class="btn red" onclick="clearSignature()">Clear Signature</button>
        <button class="btn green" onclick="sendWhatsAppWarmup()">Send via WhatsApp</button>
      </div>
      <p id="statusMsg" style="color:var(--muted);font-size:12px;"></p>
    </div>
  </section>
</main>

<footer style="text-align:center;padding:30px 0;color:var(--muted);font-size:13px;">
© 2025 MXCTECH INSULATION
</footer>

<script>
const qs = s => document.querySelector(s);
const itemsTbody = qs('#items tbody');
let items = [];

function currency(n){return "£"+(Number(n||0).toFixed(2));}

function addSelectedProduct(){
  const sel=qs('#product');
  if(!sel.value)return alert('Select a product');
  items.push({title:sel.options[sel.selectedIndex].text,price:Number(sel.value)});
  sel.value="";
  renderItems();
}
function addCustomProduct(){
  const t=qs('#customTitle').value.trim();
  const p=Number(qs('#customPrice').value);
  if(!t || !p)return alert('Enter custom product and price');
  items.push({title:t,price:p});
  qs('#customTitle').value="";qs('#customPrice').value="";
  renderItems();
}
function removeItem(i){items.splice(i,1);renderItems();}
function renderItems(){
  itemsTbody.innerHTML = items.map((it,i)=>
    `<tr><td>${it.title}</td><td style="text-align:right">${currency(it.price)}</td><td><button class="btn red" onclick="removeItem(${i})">x</button></td></tr>`
  ).join('')||`<tr><td colspan="3" style="color:#888">No products added</td></tr>`;
  recalc();
}
function recalc(){
  const admin=Number(qs('#adminFee').value||0);
  const sub=items.reduce((a,b)=>a+b.price,0);
  let subtotal=sub+admin;
  let vat=qs('#vatToggle').checked?subtotal*0.2:0;
  let total=subtotal+vat;
  qs('#subtotal').textContent=currency(subtotal);
  qs('#vat').textContent=currency(vat);
  qs('#total').textContent=currency(total);
  qs('#depOut').textContent=currency(qs('#deposit').value||0);
}
['adminFee','deposit'].forEach(id=>qs('#'+id).addEventListener('input',recalc));
qs('#vatToggle').addEventListener('change',recalc);

// Signature Pad
const canvas=document.getElementById('signature');
const ctx=canvas.getContext('2d');
let drawing=false,last=null;
function resizeCanvas(){const r=canvas.getBoundingClientRect();canvas.width=r.width;canvas.height=r.height;ctx.lineWidth=2;ctx.lineCap='round';ctx.strokeStyle='#fff';}
resizeCanvas();
window.addEventListener('resize',resizeCanvas);
canvas.addEventListener('pointerdown',e=>{drawing=true;last={x:e.offsetX,y:e.offsetY};});
canvas.addEventListener('pointermove',e=>{if(!drawing)return;ctx.beginPath();ctx.moveTo(last.x,last.y);ctx.lineTo(e.offsetX,e.offsetY);ctx.stroke();last={x:e.offsetX,y:e.offsetY};});
window.addEventListener('pointerup',()=>drawing=false);
function clearSignature(){ctx.clearRect(0,0,canvas.width,canvas.height);}

// Warm Up UK-style WhatsApp system
const CONTRACT_BASE = "https://mxctech.github.io/contract.html";
function buildWarmupContractURL(){
  const get = id=>(document.getElementById(id)?.value||"").trim();
  const params=new URLSearchParams({
    custName:get("custName"),custPhone:get("custPhone"),custEmail:get("custEmail"),
    addr1:get("addr1"),postcode:get("postcode"),apptDate:get("apptDate"),
    repName:get("repName"),jobType:get("jobType"),notes:get("notes"),
    total:(qs("#total")?.textContent||"").replace(/[^\d.]/g,""),
    deposit:(qs("#depOut")?.textContent||"").replace(/[^\d.]/g,"")
  });
  return `${CONTRACT_BASE}?${params.toString()}`;
}
function sendWhatsAppWarmup(){
  const name=(qs("#custName")?.value||"").trim();
  const phone=(qs("#custPhone")?.value||"").trim();
  if(!phone){alert("Enter WhatsApp number including +44");return;}
  const phoneDigits=phone.replace(/\D/g,"");
  const link=buildWarmupContractURL();
  const total=qs("#total")?.textContent||"£0.00";
  const deposit=qs("#depOut")?.textContent||"£0.00";
  const msg=`Hi ${name}, it’s our team from MXCTECH INSULATION.\nHere’s your contract link:\n${link}\n\nQuote Total: ${total}\nDeposit: ${deposit}`;
  const waURL=`https://api.whatsapp.com/send?phone=${phoneDigits}&text=${encodeURIComponent(msg)}`;
  window.location.href=waURL;
}
</script>
</body>
</html>
